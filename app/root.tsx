import {
  Link,
  Links,
  LiveReload,
  Meta,
  Outlet,
  Scripts,
  ScrollRestoration,
  useCatch
} from "remix";

import type { LinksFunction } from "remix";

import globalStylesUrl from "~/styles/global.css";
import darkStylesUrl from "~/styles/dark.css";

// https://remix.run/api/app#links
export let links: LinksFunction = () => {
  return [
    { rel: "stylesheet", href: globalStylesUrl },
    {
      rel: "stylesheet",
      href: darkStylesUrl,
      media: "(prefers-color-scheme: dark)"
    }
  ];
};

// https://remix.run/api/conventions#default-export
// https://remix.run/api/conventions#route-filenames
export default function App() {
  return (
    <Document>
      <Layout>
        <Outlet />
      </Layout>
    </Document>
  );
}

// https://remix.run/docs/en/v1/api/conventions#errorboundary
export function ErrorBoundary({ error }: { error: Error }) {
  console.error(error);
  return (
    <Document title="Error!">
      <Layout>
        <div>
          <h1>We encountered an error</h1>
          <p>{error.message}</p>
          <hr />
          <p>Sorry about that.</p>
        </div>
      </Layout>
    </Document>
  );
}

// https://remix.run/docs/en/v1/api/conventions#catchboundary
export function CatchBoundary() {
  let caught = useCatch();

  let message;
  switch (caught.status) {
    case 401:
      message = (
        <p>Oops! Looks like you tried to visit a page that you do not have access to.</p>
      );
      break;
    case 404:
      message = (
        <p>Oops! Looks like you tried to visit a page that does not exist.</p>
      );
      break;

    default:
      throw new Error(caught.data || caught.statusText);
  }

  return (
    <Document title={`${caught.status} ${caught.statusText}`}>
      <Layout>
        <h1>
          {caught.status}: {caught.statusText}
        </h1>
        {message}
      </Layout>
    </Document>
  );
}

function Document({
  children,
  title
}: {
  children: React.ReactNode;
  title?: string;
}) {
  return (
    <html lang="en">
      <head>
        <meta charSet="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        {title ? <title>{title}</title> : null}
        <Meta />
        <Links />
      </head>
      <body>
        {children}
        <ScrollRestoration />
        <Scripts />
        {process.env.NODE_ENV === "development" && <LiveReload />}
      </body>
    </html>
  );
}

function Layout({ children }: { children: React.ReactNode }) {
  return (
    <div className="remix-app">
      <header className="remix-app__header">
        <div className="container remix-app__header-content">
          <Link to="/" title="Logo" className="remix-app__header-home-link">
            <RemixLogo />
          </Link>
          <nav aria-label="Main navigation" className="remix-app__header-nav">
            <ul>
              <li>
                <Link to="/">Home</Link>
              </li>
              <li>
                <Link to="/posts">Posts</Link>
              </li>
              <li>
                <Link to="/admin">Admin</Link>
              </li>
            </ul>
          </nav>
        </div>
      </header>
      <div className="remix-app__main">
        <div className="container remix-app__main-content">{children}</div>
      </div>
      <footer className="remix-app__footer">
        <div className="container remix-app__footer-content">
          <p>&copy; 2021 Thomas Rettig</p>
        </div>
      </footer>
    </div>
  );
}

function RemixLogo() {
  return (
    <svg fill="currentcolor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 112 15" width="180" height="30">
  <path d="M7.7041 8.83496.786133 11.8838V9.89453L5.45508 8.02148v-.08886L.786133 6.05273V4.07031L7.7041 7.1123v1.72266ZM15.1074 12v1.5859H8.49023V12h6.61717Zm6.7949.0205c-.7519 0-1.3398-.1663-1.7636-.499-.4193-.3327-.6289-.8636-.6289-1.59279V6.42188H18.498V4.78125h1.0118V2.96289h2.0986v1.81836h1.3672v1.64063h-1.3672v3.14453c0 .32356.0684.53779.2051.64259.1367.1002.3304.1504.581.1504h.3008c.0957-.0046.1732-.0091.2324-.0137l.0752 1.6406c-.2369.0228-.6038.0342-1.1006.0342Zm4.1563-4.25878V12h-2.0918V1.9375h2.0371v3.97168h.0479c.1686-.42839.442-.77246.8203-1.03223.3828-.26432.8545-.39648 1.415-.39648.515 0 .973.11393 1.374.3418.4056.22786.7224.55371.9502.97753.2325.42383.3464.92969.3418 1.51758V12h-2.0918V7.68652c.0046-.47395-.1162-.83626-.3623-1.08691-.2415-.25521-.5765-.38281-1.0049-.38281-.4056 0-.7451.12988-1.0185.38965-.2735.2552-.4124.64029-.417 1.15527Zm9.3926 4.34768c-.7338 0-1.3741-.1527-1.9209-.458-.5423-.3054-.9639-.736-1.2647-1.292-.2962-.55601-.4443-1.20999-.4443-1.96194 0-.75195.1481-1.40592.4443-1.96191.3008-.56055.7224-.99349 1.2647-1.29883.5468-.3099 1.1871-.46484 1.9209-.46484.7383 0 1.3786.15494 1.9209.46484.5423.30534.9616.73828 1.2578 1.29883.3008.55599.4512 1.20996.4512 1.96191 0 .7474-.1504 1.40137-.4512 1.96194-.2962.556-.7155.9866-1.2578 1.292-.5423.3053-1.1826.458-1.9209.458Zm0-1.627c.4466 0 .8089-.1845 1.0869-.55369.2825-.3737.4238-.88411.4238-1.53125 0-.65169-.1413-1.16439-.4238-1.53808-.278-.37826-.6403-.56739-1.0869-.56739-.4558 0-.8226.18685-1.1006.56055-.2735.3737-.4102.88867-.4102 1.54492.0046.64714.1436 1.15755.417 1.53125.278.36919.6426.55369 1.0938.55369ZM39.9492 12V4.78125h2.0235v1.31934H42c.1595-.43295.4284-.7793.8066-1.03907.3829-.25976.8295-.38964 1.3399-.38964.5241 0 .973.13444 1.3467.40332.3782.26432.6198.61067.7246 1.03906h.0273c.1459-.41927.4216-.76335.8272-1.03223.4056-.27344.8886-.41015 1.4492-.41015.7018 0 1.2806.2233 1.7363.66992.4557.44661.6836 1.08008.6836 1.90039V12h-2.1055V7.65234c0-.41927-.1116-.73372-.3349-.94336-.2233-.20963-.5036-.31445-.8408-.31445-.3737 0-.67.12077-.8887.36231-.2142.24153-.3213.55826-.3213.95019V12h-2.0166V7.60449c0-.36914-.1071-.66308-.3213-.88183-.2096-.21875-.4876-.32813-.834-.32813-.3463 0-.638.12077-.875.36231-.237.24153-.3554.58561-.3554 1.03222V12h-2.0987Zm14.9639.123c-.5742 0-1.0938-.1481-1.5586-.4443-.4603-.2962-.8249-.7337-1.0938-1.3125-.2688-.57877-.4033-1.2897-.4033-2.1328 0-.86589.139-1.58366.417-2.15332.278-.57422.6494-1.00488 1.1143-1.29199.4648-.28711.9752-.43067 1.5312-.43067.4193 0 .7702.07064 1.0528.21192.2825.14127.5104.31673.6835.52636.1778.20964.3122.41927.4034.62891h.0615V4.45312h2.0918V12h-2.0645v-1.21h-.0888c-.0957.2097-.2347.417-.417.6221-.1778.2051-.4079.376-.6905.5127-.2825.1322-.6289.1982-1.039.1982Zm.6631-1.6679c.5013 0 .8909-.2028 1.1689-.60842.278-.4056.417-.94564.417-1.62012s-.139-1.20996-.417-1.60644c-.2734-.40104-.6631-.60157-1.1689-.60157-.515 0-.9092.20508-1.1826.61524-.2689.4056-.4034.93652-.4034 1.59277 0 .66081.1368 1.19857.4102 1.61328.2734.41016.6654.61526 1.1758.61526Zm10.8965-3.3633h-1.9483c-.0045-.28256-.1185-.50586-.3418-.66992-.2233-.16407-.499-.2461-.8271-.2461-.3008 0-.5515.06152-.752.18457-.2005.11849-.3008.278-.3008.47852 0 .33724.2849.5651.8545.68359l1.3535.2666c.67.13672 1.1918.36003 1.5655.66992.3782.30534.5674.73601.5674 1.292 0 .49222-.139.91602-.417 1.27152-.278.3509-.6586.622-1.1416.8134-.4831.1869-1.0345.2803-1.6543.2803-.989 0-1.7819-.2119-2.3789-.6357-.5925-.4284-.9183-1.0209-.9776-1.77738h2.0713c.0365.30538.1686.53318.3965.68358.2279.1504.5264.2256.8955.2256.3236 0 .5856-.057.7861-.1709.2051-.1185.3076-.2825.3076-.49218 0-.19141-.0843-.33724-.2529-.4375-.164-.10026-.3828-.17774-.6562-.23242l-1.2373-.23926c-.7246-.14128-1.2647-.39193-1.6202-.75195-.3509-.36003-.5263-.81348-.5263-1.36036 0-.70182.278-1.25097.834-1.64746.5605-.40104 1.3079-.60156 2.2422-.60156.9433 0 1.6998.21419 2.2695.64258.5742.42383.8704 1.014.8887 1.77051ZM70.6973 12V4.78125h2.0234v1.30566h.0547c.2825-.94336.8568-1.41503 1.7226-1.41503.114 0 .2234.00683.3282.0205.1048.01367.1982.0319.2802.05469v1.85938c-.1002-.03646-.2347-.06609-.4033-.08887-.1686-.02279-.3281-.0319-.4785-.02735-.401-.00455-.7406.12989-1.0185.40332-.278.26888-.417.65398-.417 1.15528V12h-2.0918Zm8.0732.1094c-.7292 0-1.3626-.1504-1.9004-.4512-.5332-.3053-.9456-.736-1.2373-1.292-.2871-.55598-.4307-1.21223-.4307-1.96874 0-.73828.1436-1.38542.4307-1.94141.2917-.56054.7018-.99804 1.2305-1.3125.5286-.31445 1.1484-.47167 1.8594-.47167.7063 0 1.317.15494 1.832.46484.515.30534.9114.736 1.1894 1.29199.2826.55599.4239 1.20996.4239 1.96191v.48536h-4.9424v.05468c-.0046.46941.1321.86589.4101 1.18944.278.319.6631.4808 1.1553.4854.3418-.0046.6426-.0843.9024-.2393.2643-.1595.4397-.37369.5263-.64257h1.8867c-.1276.72007-.4899 1.29887-1.0869 1.73637-.5924.4375-1.3421.6539-2.249.6494ZM77.2256 7.625h3.0351c-.0136-.42839-.164-.77474-.4511-1.03906-.2871-.26888-.6403-.4056-1.0596-.41016-.4375.00456-.7952.14811-1.0732.43067-.278.28255-.4284.62207-.4512 1.01855Zm8.8252 4.3955c-.752 0-1.3399-.1663-1.7637-.499-.4193-.3327-.6289-.8636-.6289-1.59279V6.42188h-1.0117V4.78125h1.0117V2.96289h2.0986v1.81836h1.3672v1.64063h-1.3672v3.14453c0 .32356.0684.53779.2051.64259.1367.1002.3304.1504.5811.1504h.3008c.0957-.0046.1731-.0091.2324-.0137l.0752 1.6406c-.237.0228-.6039.0342-1.1006.0342Zm5.0859 0c-.7519 0-1.3398-.1663-1.7637-.499-.4192-.3327-.6289-.8636-.6289-1.59279V6.42188h-1.0117V4.78125h1.0117V2.96289h2.0987v1.81836H92.21v1.64063h-1.3672v3.14453c0 .32356.0683.53779.2051.64259.1367.1002.3304.1504.581.1504h.3008c.0957-.0046.1732-.0091.2324-.0137l.0752 1.6406c-.237.0228-.6038.0342-1.1006.0342ZM93.2012 12V4.78125h2.0986V12h-2.0986Zm1.0527-8.16211c-.3281 0-.6084-.10937-.8408-.32812-.2279-.22331-.3395-.48991-.335-.79981-.0045-.30989.1071-.57422.335-.79297.2324-.22331.5127-.33496.8408-.33496.3236 0 .5993.11165.8272.33496.2278.21875.344.48308.3486.79297-.0046.3099-.1208.5765-.3486.79981-.2279.21875-.5036.32812-.8272.32812Zm5.626 11.11521c-1.0436 0-1.8526-.2119-2.4268-.6357-.5742-.4238-.8978-.9844-.9707-1.6817h2.0303c.0638.2735.221.4763.4717.6084.2506.1322.556.1983.916.1983.4606 0 .8206-.1162 1.0796-.3486.26-.2279.39-.5925.39-1.0938v-1.1484h-.027c-.164.36-.429.6448-.793.8545-.365.2096-.8023.3144-1.3127.3144-.8522 0-1.554-.3076-2.1055-.9228-.5468-.6198-.8203-1.52446-.8203-2.71391 0-.81576.1322-1.49935.3965-2.05078.2689-.55143.6244-.96615 1.0664-1.24414.4466-.278.9343-.41699 1.4629-.41699.401 0 .7383.06835 1.0117.20507.278.13216.504.29851.677.49903.173.20052.305.40104.396.60156h.034V4.78125h2.085V11.918c0 1.039-.325 1.8047-.977 2.2968-.652.4922-1.513.7383-2.5841.7383Zm.0137-4.5459c.4644 0 .8274-.1754 1.0864-.52634.26-.35547.39-.85221.39-1.49024 0-.64713-.13-1.14843-.39-1.5039-.259-.36003-.617-.54004-1.0728-.54004-.4694 0-.8294.18457-1.0801.55371-.2506.36914-.3759.86589-.3759 1.49023 0 .6198.123 1.11198.3691 1.47657.2461.36001.6039.54001 1.0733.54001Z" fill="currentcolor"/>
</svg>
  );
}
